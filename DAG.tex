\documentclass[landscape]{article}
\usepackage[paperwidth=222mm, paperheight=165mm, margin=0cm]{geometry}
\usepackage{tikz}
\usepackage{xcolor}
\definecolor{myBlue}{RGB}{173, 216, 230}
\definecolor{myGrey}{RGB}{230, 230, 230}
\usetikzlibrary{positioning, shapes.geometric, arrows}
\usepackage{amsmath}

% Define styles
\tikzstyle{node} = [rectangle, rounded corners, minimum width=1.5cm, minimum height=1cm, text centered, draw=black]
\tikzstyle{arrow} = [thick,->,>=stealth]

\begin{document}

\begin{figure}[h]
    \centering
    \begin{tikzpicture}[node distance=1.5cm]


%%%%%%%%%%% TRUE FISH %%%%%%%%%%%
\node (Fish_TRUE) [node, fill=myBlue] at (-3.5,0.8) {
    \textbf{$X$}
};
\node [above=of Fish_TRUE, yshift=-1.5cm, font=\large\bfseries] {Fish density};

%%%%%%%%%%% Water %%%%%%%%%%%
\node (water) [node, below=of Fish_TRUE, fill=myBlue]  at (0,0) {
    $\begin{array}{c}
        %\lambda_{i} = W_{i} \cdot \omega
        X_i =  W_{i} \cdot \omega
        %W_{i} = \lambda_{i} \cdot \omega
    \end{array}$
};
\node [above=of water, xshift=0.7cm, yshift=-1.5cm, font=\large\bfseries] {Water model};
\node[anchor=south east] at ([xshift=5pt, yshift=-15pt] water.south east) {\textbf{(2)}};


%%%%%%%%%%% Air %%%%%%%%%%%
\node (air) [node, below=of Fish_TRUE, fill=myBlue]  at (8,0.25) {
    $\begin{array}{c}
        \ln(W_{i}) = \eta_{j} + \ln(A_{ij}) + \varepsilon_{ij} \\
        \ln(A_{ij}) = \ln(A_{ijb}) + \delta_{b} \\
        \delta_{b} \sim \mathcal{N}(0,\tau)
        %\ln(A_{ij}) = \eta_{j} + \ln(W_{i}) + \varepsilon_{ij} \vspace{3px}\\
        %A_{ij} = \frac{1}{B} \cdot \sum_{b=1}^{B} A_{ijb} \vspace{3px}\\
        %\delta_{b} = A_{ij} - A_{ijb} \\
    \end{array}$
};
\node [above=of air, yshift=-1.5cm, font=\large\bfseries] {Air model};
\node[anchor=south east] at ([xshift=5pt, yshift=-15pt] air.south east) {\textbf{(3)}};


%%%%%%%%%%% Visual %%%%%%%%%%%
\node (visual) [node, below=of Fish_TRUE, fill=myBlue]  at (-7,0) {
    $\begin{array}{c}
        X_i = \lambda_{i} \cdot E_{i}^{-1} \\
        N_{i} \sim Poisson(\lambda_{i})
    \end{array}$
};
\node [above=of visual, xshift=-0.7cm, yshift=-1.5cm, font=\large\bfseries] {Visual model};
\node[anchor=south east] at ([xshift=5pt, yshift=-15pt] visual.south east) {\textbf{(1)}};



%%%%%%%%%%% qPCR env water %%%%%%%%%%%
\node (qPCR_en_wat) [node, below=of water, fill=myBlue]  at (0,-3) {
    $\begin{array}{l}
        Z_{it} \sim \mathrm{Bernoulli} \left(\psi_{i}\right) \\
        %logit(\psi_{i}) = \phi0 + \phi1 \cdot \ln (W_{i}) \\
        \psi_{i} = 1 - exp(-W_{i} \cdot \phi) \\
        Y_{itp} \sim \mathrm{Normal} (\mu_{ip}, \sigma_{i}) \quad \textnormal{if } Z_{it} = 1 \\
        \mu_{ip} = \beta0 + \beta1_{p} \cdot \ln (W_{i}) \\
        \sigma_{i} = \exp(\gamma0 + \gamma1 \cdot \ln (W_{i}))
    \end{array}$
};
\node [above=of qPCR_en_wat, xshift=2.1cm, yshift=-1.5cm, font=\large\bfseries] {qPCR water model};
\node[anchor=south east] at ([xshift=5pt, yshift=-15pt] qPCR_en_wat.south east) {\textbf{(4)}};  



%%%%%%%%%%% qPCR env air %%%%%%%%%%%
\node (qPCR_en_air) [node, below=of air, fill=myBlue]  at (8,-3) {
    $\begin{array}{l}
        Z_{ijbt} \sim \mathrm{Bernoulli} \left(\psi_{ijb}\right) \\
        %logit(\psi_{ijb}) = \phi0 + \phi1 \cdot \ln (A_{ijb}) \\
        \psi_{ijb} = 1 - exp(-A_{ijb} \cdot \phi) \\
        Y_{ijbtp} \sim \mathrm{Normal} (\mu_{ijb}, \sigma_{ijb}) \quad \textnormal{if } Z_{ijbt} = 1 \\
        \mu_{ijb} = \beta0 + \beta1_{p} \cdot \ln (A_{ijb}) \\
        \sigma_{ijb} = \exp(\gamma0 + \gamma1 \cdot \ln (A_{ijb}))
    \end{array}$
};
\node [above=of qPCR_en_air, xshift=2.0cm, yshift=-1.5cm, font=\large\bfseries] {qPCR air model};
\node[anchor=south east] at ([xshift=5pt, yshift=-15pt] qPCR_en_air.south east) {\textbf{(5)}};  



%%%%%%%%%%% qPCR std water %%%%%%%%%%%
\node (qPCR_st) [node, below=of qPCR_en_wat, fill=myBlue] at (4,-7) {
    $\begin{array}{l}
        Z_{kr} \sim \mathrm{Bernoulli} \left(\psi_{k}\right) \\
        %logit(\psi_{k}) = \phi0 + \phi1 \cdot \ln (K_{k}) \\
        (\psi_{k}) = 1 - exp(-K_{k} \cdot \phi) \\
        Y_{kr} \sim \mathrm{Normal} (\mu_{k}, \sigma_{k}) \quad \textnormal{if } Z_{kr} = 1 \\
        \mu_{k} = \beta0 + \beta1_{p} \cdot \ln (K_{k}) \\
        \sigma_{k} = \exp(\gamma0 + \gamma1 \cdot \ln (K_{k}))
    \end{array}$
};
\node [below=of qPCR_st, xshift=-0.5cm, yshift=1.5cm, font=\large\bfseries] {qPCR Standard model};
\node[anchor=south west] at ([xshift=-15pt, yshift=-15pt] qPCR_st.south east) {\textbf{(6)}};


 % Arrows
        \draw [->, thick] (Fish_TRUE) -- node[midway, left] {E} (visual);
        \draw [->, thick] (Fish_TRUE) -- node[midway, left] {$\omega$} (water);
        \draw [<->, thick] (water) -- node[midway, above] {$\varepsilon_{ij}, \eta_j$} (air);
        \draw [<-, thick] (qPCR_en_air) -- node[midway, left] {$A_{ijb}$} (air);
        \draw [<-, thick] (qPCR_en_wat) -- node[midway, left] {$W_i$} (water);

        \draw [->, thick] (qPCR_st) -- node[midway, right, xshift=28pt] {
        $\begin{array}{c}
            \phi0, \phi1 \\ \beta0, \beta1_p \\ \gamma0, \gamma1
        \end{array}$} (qPCR_en_wat);
        \draw [->, thick] (qPCR_st) -- node[midway, right, xshift=8pt] {} (qPCR_en_air);



\node (parameters) [rectangle, draw, 
align=left, right=of qPCR_st, text width=8.1cm, fill=myGrey] at (-11.63,-10.5) {
\small{
      \begin{tabular}{cl}
    &\textbf{Parameters} \\
    $\lambda$ & Poisson rate parameter\\
    $\psi$&probability of positive qPCR amplification \\
    $\phi$ & detection probability intercept function\\
    & and DNA concentration (K and W or A) \\
    $\mu$&mean Ct values of qPCR \\
    $\beta0, \beta1$&intercept and slope between $\mu$ and \\
    &DNA concentration (K and W or A) \\
    $\sigma$&standard deviation of qPCR Ct values \\
    $\gamma0, \gamma1$&intercept and slope between $\sigma$ and\\
    &DNA concentration (K and W or A) \\
    $\omega$&conversion parameter between fish density\\
    &and DNA concentration\\
    $\varepsilon$&error term (residual) \\
    $\eta$&dilution factor of DNA concentration\\
    &from water to air \\
    $\delta$&biological replicate error (bio-rep residual)
    \end{tabular}
    }
};

% Legend: Subscripts
\node (subscripts) [rectangle, draw, align=left, below=of qPCR_st, text width=6cm, fill=myGrey] at (-7,-2.4) {
\small{
      \begin{tabular}{cl}
    &\textbf{Subscripts} \\
    $i$&time \\
    $j$&filter type \\
    %$j$&sample\\
    $b$&biological replicate\\
    $t$&technical replicate \\
    $p$&qPCR plate \\
    $k$&qPCR standard sample
        \end{tabular}
    }
};

\node (data) [rectangle, draw, align=left, above=of air, text width=7cm, fill=myGrey] at (8,-2.0){
\small{
      \begin{tabular}{cl}
    &\textbf{Data} \\
    $N$&number of counted fish \\
    $E$&days between counting (effort)\\
    $Z$&qPCR amplification (yes=1; no=0) \\
    $Y$&qPCR Ct values \\
    $K$&Known concentration in copies/$\mu$L
     \end{tabular}
    }
};

% Legend: State variables
\node (state) [rectangle, draw, align=left, right=of qPCR_st, text width=10.5cm, fill=myGrey] at (-0.5,-13.2){
\small{
      \begin{tabular}{cl}
    &\textbf{State variables} \\
    $W$&unknown eDNA concentration in water samples (copies/$\mu$L) \\
    $A$&unknown eDNA concentration in air samples (copies/$\mu$L)\\
    $X$&unknown fish density (fish/day) \\
         \end{tabular}
    }
};
    \end{tikzpicture}
    %\caption{Multifish DAG}
\end{figure}

\end{document}
